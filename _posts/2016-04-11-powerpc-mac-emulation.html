---
layout: post
title: PowerPC Mac Emulation
date: 2016-04-11 10:00:07.000000000 -04:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Digital Preservation
tags:
- Darwin
- Emaculation
- emulation
- ohmygoditssoslow
- OSX Tiger
- PearPC
- PowerPC
- virtualization
meta:
  _thumbnail_id: '296'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '21677360661'
author:
  login: bestfilmsofourlives
  email: e.gates42@gmail.com
  display_name: Ethan
  first_name: ''
  last_name: ''
---
<p>A couple weeks ago Mona Jimenez asked me to step into her course on Handling Complex Media, to help a student group with a tech request (business as usual). Going back to the lab, I had a hint of what was coming from the whiteboard:</p>
<p>[caption id="attachment_122" align="aligncenter" width="618"]<img class="  wp-image-122 aligncenter" src="{{ site.baseurl }}/images/img_2166.jpg" alt="IMG_2166" width="618" height="463" /> Uh oh.[/caption]</p>
<p>Yes, as it turned out, the students were working with a piece of multimedia artwork/software that required a PowerPC version of Mac OSX (10.0 through 10.5) in order to run. Normally, this wouldn't present much of an issue, as MIAP's "Old Media Lab" still has several old Power Mac G4 desktops and even a couple Macbook laptops running various early versions of Mac OSX. However, the students would only have access to the digital materials on-site at the partner institution for this project, and could not bring the software back to NYU. They could (and might still, if it comes to it) just bring the laptops to the site and run the software in the native environment, but that's unideal for a couple reasons: first, I'm always somewhat hesitant for department equipment to leave campus; and second, having old hardware running these old operating systems natively is something of a luxury, which our students may very well not have in the future as equipment continues to age, or if they work at an institution with shallower pockets for digital preservation.</p>
<p>In order to access software or digital files created for obsolete systems, the primary solutions these days are emulation and virtualization - two slightly different methods of, essentially, using software to trick a contemporary computer into mimicking the behavior and limitations of other hardware and/or operating systems. Emulation has gotten incredibly sophisticated recently - the Internet Archive has even made it possible to run <a href="https://archive.org/details/historicalsoftware" target="_blank">thousands</a> of vintage MS-DOS and Windows 3.1 programs from an emulator <em>inside your web browser</em>, no additional downloads required, which is really an incredible feat of programming. Emulators for early Mac systems (anywhere from 1.0 to 9.x) are relatively simple to set up in OSX 10.10 (Yosemite) or 10.11 (El Capitan), likewise virtual machine software like <a href="https://www.virtualbox.org/" target="_blank">VirtualBox</a> (all topics for another day).</p>
<p>But right now the early, PowerPC versions of OSX seem to be something of an emulation/virtualization dead zone. I'm not the person to ask why - I'm assuming that the shift from PowerPC to Intel processors (starting with OSX 10.6, Snow Leopard), shifted the system architecture dramatically while the operating system remained relatively the same, resulting in a particular hardware/software configuration that just confuses the heck out of current setups, even through an emulator. It's clearly possible - sift through the forums of <a href="http://www.emaculation.com/doku.php" target="_blank">Emaculation</a> or other emulation enthusiast sites and you'll find five-year-old boasts of people getting OSX Puma to run in Windows XP, or whatever - but documentation is sketchy and scattered even by internet standards, and replication therefore a crapshoot.</p>
<p>So, how do I help these students get a PowerPC version of OSX on one of their (Intel Mac) laptops? Anytime we need new Mac software in the department, I try it out first on my office computer, a mid-2011 iMac running OSX 10.10.5.</p>
<p>[caption id="attachment_202" align="aligncenter" width="299"]<img class="  wp-image-202 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-9-18-20-am.png" alt="Screen Shot 2016-04-07 at 9.18.20 AM" width="299" height="486" /> Note: I can't even <em>use</em> some of this stuff, but it's cluttering up my desktop anyway.[/caption]</p>
<p>I eliminate using VirtualBox almost right off the bat - the makers of VirtualBox explicitly state that the software does not support PowerPC architecture, which, again, doesn't mean it's impossible, but it does mean that unless I magically have the same computer setup as a <a href="https://www.youtube.com/watch?v=-N1wZ8sDZvI" target="_blank">random YouTube user</a>, I'm completely on my own. Instead I'm going to use PearPC, an old PowerPC architecture emulator (it hasn't been updated since 2011), but one with some <a href="http://pearpc.sourceforge.net/about.html" target="_blank">solid documentation</a> to get started. I'll be trying to install OSX Tiger (10.4) in PearPC, as we still have a couple original installation discs for Tiger still lying around the department, and Apple install discs are otherwise hard to come by (if you don't like going to/supporting super dubious torrent sites, or buying overly expensive copies off Amazon).</p>
<p>PearPC recommends installing Darwin as your client OS (the OS running inside the emulation software) first, to properly partition and format your virtual hard disk (the fake hard drive the emulator will use to make the OS think it's being installed directly on to a piece of hardware). But I immediately just ignored that because WHAT THE HELL IS DARWIN?! So, I skip to just downloading the PearPC 0.5 source archive for Unix (e.g. Mac) systems.</p>
<p>Uh oh. A source archive means the software needs to be compiled before it will actually run. Normally I would immediately turn away and go find someone who had already compiled a packaged OSX build FOR me, but the PearPC documentation includes some seemingly straightforward command-line instructions for this step. So, I open a Terminal window, navigate into the PearPC-0.5 directory, and attempt a default configuration and make with</p>
<blockquote><p>$ ./configure &amp;&amp; make</p></blockquote>
<p>Lots of Terminal gobbledygook aaaaand PearPC seems to automatically detect my system configuration fine:</p>
<p><img class="  wp-image-228 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-9-46-37-am.png" alt="Screen Shot 2016-04-07 at 9.46.37 AM" width="531" height="331" /></p>
<p>But then in the make....</p>
<p><img class="  wp-image-231 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-9-47-55-am.png" alt="Screen Shot 2016-04-07 at 9.47.55 AM" width="514" height="321" /></p>
<p>Oops. I have no idea what this 'MAP_32BIT' identifier is, nor how to change it, nor if that's really even the issue here. So ends my efforts to self-compile - pretty please, tell me someone has already done this for me?</p>
<p>[caption id="attachment_237" align="aligncenter" width="193"]<img class="alignnone size-full wp-image-237 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-9-50-17-am1.png" alt="Screen Shot 2016-04-07 at 9.50.17 AM.png" width="193" height="250" /> "I'll save you, Ethan!"[/caption]</p>
<p>Huzzah! Google directs me to this very nice Dutch expert (who is also apparently secretly a cat on his 7th life) in the Emaculation forums has <a href="http://www.emaculation.com/forum/viewtopic.php?t=5757" target="_blank">already compiled</a> an Intel Mac OSX build of PearPC. YOINK.</p>
<p>Per the Dutch Cat, I still need a configuration file and a blank hard disk image. So it turns out to be good that I downloaded that Unix source archive, even if the compiling didn't work, because I can just steal the "ppccfg.example" configuration file from that directory and move it into my OSX build directory. It's just a simple text file, so I can rename it whatever I want for clarity's sake.</p>
<p><img class=" size-full wp-image-246 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-9-58-26-am.png" alt="Screen Shot 2016-04-07 at 9.58.26 AM.png" width="109" height="117" /></p>
<p>Now I need the blank hard disk image. Back in the PearPC documentation, we've got some <a href="http://pearpc.sourceforge.net/idesetup.html" target="_blank">handy details</a> on the specs needed (a multiple of 3GiB size, in particular), and how about that, a sample dd command to make one. When I did this I just used 3GiB, but I'd recommend the 6GiB size, just to make sure you have room for the installation of OSX Tiger and something leftover:</p>
<blockquote><p>$ dd if=/dev/zero of=~/Desktop/pearpc_osx_generic/PearPCTiger.img bs=516096 seek=6241 count=0</p></blockquote>
<p>My OSX build directory now looks something like this in a Finder window:</p>
<p><img class="  wp-image-255 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-03-36-am.png" alt="Screen Shot 2016-04-07 at 10.03.36 AM.png" width="520" height="287" /></p>
<p>Dandy. Now I just need to set up the configuration file, so the PearPC application is directed to the blank hard disk image and the OSX Tiger install disc (currently sitting unmounted in my iMac's optical drive) when it tries to boot up. So I open the configuration file with a simple text editor (TextEdit, Xcode, even Word will do) and find and change the comment lines that correspond to the hard disk image and install disc paths (you can find path to your mount point for an optical drive by running the command "$ diskutil list" in a Terminal window, then running "$ umount /path/to/disc/drive/" to make sure your host computer unmounts the disc - in most cases, if your desktop/laptop just has a hard drive with one partition and one optical drive, the path will be /dev/disk1)</p>
<p><img class=" size-full wp-image-293 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-45-05-am.png" alt="Screen Shot 2016-04-07 at 10.45.05 AM.png" width="291" height="127" /><br />
Save the configuration file and we're ready to go, right? Back to Terminal, because PearPC is a command-line application, navigate into the OSX build directory, and run the executable file in the build with</p>
<blockquote><p>$ ./ppc_osx_generic "osxtiger.rawr"</p></blockquote>
<p><img class=" size-full wp-image-275 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-23-09-am.png" alt="Screen Shot 2016-04-07 at 10.23.09 AM.png" width="579" height="352" /></p>
<p>Aaaaand nothing happens. I'm just sitting on the cursor. Why? Tell me, Dutch Cat Man!</p>
<p><img class="alignnone size-full wp-image-279 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-26-54-am.png" alt="Screen Shot 2016-04-07 at 10.26.54 AM.png" width="341" height="122" /></p>
<p>As it turns out, the X in "OSX" doesn't <em>just</em> mean "10." It also refers to the X Windows System, a development framework for making applications with graphical user interface windows on Unix systems. It's a standard component in OSX (indeed, in pretty much all Mac OSs over the years), but you need to download some extra software to allow cross-platform software like PearPC to run on it. <a href="https://xquartz.macosforge.org/trac" target="_blank">This software</a>!</p>
<p>[caption id="attachment_288" align="aligncenter" width="94"]<img class="  wp-image-288 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-35-55-am.png" alt="Screen Shot 2016-04-07 at 10.35.55 AM.png" width="94" height="95" /> So many Xs.[/caption]</p>
<p>All right, XQuartz is now installed, and since I forgot to terminate PearPC and it's been running this whole time in the background, suddenly XQuartz opens, PearPC starts running and booting from the OSX Tiger install disc.</p>
<p><img class="  wp-image-296 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-46-48-am.png" alt="Screen Shot 2016-04-07 at 10.46.48 AM.png" width="522" height="405" /></p>
<p>I get the classic gray apple screen, then after a moment, some terrifying-looking text appears. Then...it just sits there. For too long.</p>
<p><img class="  wp-image-300 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-50-47-am.png" alt="Screen Shot 2016-04-07 at 10.50.47 AM.png" width="513" height="390" /></p>
<p>That can't be good. Perhaps I'm getting too fancy trying to boot off the physical disc in my host computer's optical drive - what if I make an image of that instead, and plug it into the PearPC configuration file? There are many options for making disk images, and that's a whole other topic. I'm going to run the absolute simplest of my command-line options right now and see how that goes:</p>
<blockquote><p>$ cp /dev/disk1 ~/Desktop/pearpc_osx_generic/Mac_OSX_Tiger_Install_DVD.iso</p></blockquote>
<p>Once that's finished running, I go back into the configuration file and edit the line that corresponds to the install disk image:</p>
<p><img class=" size-full wp-image-308 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-59-34-am.png" alt="Screen Shot 2016-04-07 at 10.59.34 AM.png" width="380" height="128" /></p>
<p>What happens if I run the PearPC executable again now? I've booted back to the scary text screen again, but...</p>
<p><img class="  wp-image-313 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-10-54-59-am.png" alt="Screen Shot 2016-04-07 at 10.54.59 AM.png" width="571" height="438" /></p>
<p>This time it keeps running! I let things scroll for a minute and eventually am greeted by a very familiar sight....</p>
<p><img class="  wp-image-316 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-11-03-04-am.png" alt="Screen Shot 2016-04-07 at 11.03.04 AM.png" width="610" height="472" /></p>
<p>A Mac Installer wizard! We did it everybody!</p>
<p><img class=" size-full wp-image-351 aligncenter" src="{{ site.baseurl }}/images/brad-pitt.gif" alt="brad-pitt" width="240" height="192" /></p>
<p>Well, not quite yet. I start to move through the Installer but we haven't actually formatted that blank hard disk image to make it capable of having Mac OSX installed on it yet. So, when stuck at the "Select Destination" screen with no options for where to install the OS, I'm going to head into the "Utilities" tab and enter Mac's Disk Utility software.</p>
<p><img class=" size-full wp-image-321 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-11-05-28-am.png?w=600" alt="Screen Shot 2016-04-07 at 11.05.28 AM.png" width="600" height="465" /></p>
<p>In order to format my blank hard disk image, I'm going to select the image from the left-hand menu, navigate to the "Partition" tab, then select "1 Partition" in the Volume Scheme and "Mac OS Extended (Journaled)" as the Format, and click Partition in the lower-right to execute.</p>
<p>[caption id="attachment_327" align="aligncenter" width="615"]<img class="  wp-image-327 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-11-08-51-am.png" alt="Screen Shot 2016-04-07 at 11.08.51 AM.png" width="615" height="476" /> Please do not ask me why Disk Utility is shouting at me in German.[/caption]</p>
<p>Once that's finished, I'm able to exit Disk Utility and return to the Installer - and the formatted hard disk image is now available to select as an installation destination. Now, OSX Tiger needs about 4.8GB of space to install in its entirety, which is why I told you to make a 6GiB image earlier. If you've made a smaller, 3GiB image as I did, you'll have to de-select some of the installation packages. It's not that big a deal - a ton of space is taken up by non-essential features like device drivers and extra languages.</p>
<p>[caption id="attachment_331" align="aligncenter" width="621"]<img class="  wp-image-331 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-11-14-26-am.png" alt="Screen Shot 2016-04-07 at 11.14.26 AM.png" width="621" height="484" /> And I was so looking forward to doing this again in Russian.[/caption]</p>
<p>OSX Tiger is now ready to install. Now, if you're following along, you may have noticed at this point that PearPC runs slooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooow</p>
<p><img class="  wp-image-357 aligncenter" src="{{ site.baseurl }}/images/44a5f1b6b0dce7c0e0b3a658756533f62481c1e05da3c693841ec7f6ec682a7c.jpg" alt="44a5f1b6b0dce7c0e0b3a658756533f62481c1e05da3c693841ec7f6ec682a7c" width="455" height="455" /></p>
<p>So yeah, this installation takes a while. Like possibly hours, plural. I went off to do some other work and forgot to tell my host computer not to go to sleep, which made PearPC just pause the installation for about an extra hour. Don't do that.</p>
<p>OSX Tiger did successfully install, however, but here's the kicker - as I went through the initial setup, it turns out that PearPC did something COMPLETELY WONKY to the mapping on my keyboard during that installation. So, when trying to set up a user account and just typing like a normal person, I got this nonsense:</p>
<p><img class="  wp-image-371 aligncenter" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-1-11-15-pm.png" alt="Screen Shot 2016-04-07 at 1.11.15 PM.png" width="549" height="424" /></p>
<p>I wish I could tell you that I solved this problem, but no, I just had to painstakingly poke at one button at a time until I figured out that now while in PearPC, e=delete, 4=n, v=9, so on and so forth. When I finally got into the OSX Tiger desktop and was able to go to System Preferences, I thought I had fixed it by switching to a Canadian keyboard layout (why do you even have a separate keyboard layout, Canada?), but now every time I boot back into PearPC it resets. So that's a mystery and if anyone has ideas how to fix this I'm all ears.</p>
<p><img class="aligncenter size-full wp-image-373" src="{{ site.baseurl }}/images/screen-shot-2016-04-07-at-1-15-26-pm.png?w=527" alt="Screen Shot 2016-04-07 at 1.15.26 PM.png" width="527" height="415" /></p>
<p>But, for the moment I'm calling this mission accomplished. Again, OSX Tiger in PearPC runs AS SLOW AS DIRT, so this is not ideal, and I would still like to figure out how to crack the VirtualBox solution for all this. But from what I can tell that might involve this mysterious Darwin operating system that apparently makes all my Apple computers work...and given how this post has already turned out much longer than I intended, that's a topic for another day.</p>
<p>[caption id="attachment_348" align="aligncenter" width="128"]<img class=" size-full wp-image-348 aligncenter" src="{{ site.baseurl }}/images/128px-hexley_the_platypus-svg.png" alt="128px-hexley_the_platypus-svg" width="128" height="156" /> WHAT ARE YOU[/caption]</p>
<p>If you've had any success setting up a PowerPC Mac OS in an emulator or VM, I'd love to hear about it!</p>
